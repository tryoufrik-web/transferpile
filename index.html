<!DOCTYPE html>
<html>
<head>
    <title>üì± Wireless File Transfer - 2 Device</title>
    <meta charset="UTF-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #0a0f1e; 
            color: white; 
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        
        h1 { 
            color: #00ffff; 
            text-align: center; 
            margin-bottom: 30px;
            font-size: 2em;
        }
        
        .dual-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .device {
            background: #1a1f2e;
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 20px;
        }
        
        .device-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00ffff;
        }
        
        .device-header i {
            font-size: 2em;
            color: #00ffff;
        }
        
        .code-box {
            background: #0a0f1e;
            border: 2px dashed #00ffff;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .code {
            font-size: 3em;
            font-weight: bold;
            color: #00ffff;
            letter-spacing: 10px;
            margin: 10px 0;
        }
        
        .input-area {
            margin: 20px 0;
        }
        
        .input-label {
            color: #88ffff;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
        }
        
        .code-input {
            flex: 1;
            padding: 15px;
            font-size: 1.5em;
            background: #0a0f1e;
            border: 2px solid #00ffff;
            border-radius: 8px;
            color: white;
            text-align: center;
            letter-spacing: 5px;
        }
        
        .code-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }
        
        button {
            background: #00ffff;
            color: black;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
        }
        
        button:hover {
            background: #00cccc;
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background: #0a0f1e;
            border-radius: 8px;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: red;
        }
        
        .dot.green {
            background: #00ff88;
            box-shadow: 0 0 10px #00ff88;
        }
        
        .file-zone {
            border: 2px dashed #00ffff;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
        }
        
        .file-zone:hover {
            background: #1a1f2e;
        }
        
        .file-list {
            background: #0a0f1e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #333;
        }
        
        .transfer-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            margin-top: 10px;
            background: #00ff88;
            color: black;
        }
        
        .download-btn {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background: #ffaa00;
            color: black;
        }
        
        .logs {
            margin-top: 30px;
            background: #0a0f1e;
            border-radius: 8px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
        }
        
        .hidden {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-exchange-alt"></i> Wireless File Transfer</h1>
        
        <!-- DUAL DEVICE -->
        <div class="dual-panel">
            <!-- DEVICE 1 - LAPTOP -->
            <div class="device">
                <div class="device-header">
                    <i class="fas fa-laptop"></i>
                    <h2>DEVICE 1 - LAPTOP</h2>
                </div>
                
                <!-- KODE DEVICE 1 -->
                <div class="code-box">
                    <div style="color: #88ffff; margin-bottom: 5px;">üîë KODE ANDA</div>
                    <div class="code" id="code1">ABCD</div>
                    <button onclick="copyCode('1')" style="margin-top: 10px;">
                        <i class="fas fa-copy"></i> COPY KODE
                    </button>
                    <button onclick="newCode('1')" style="margin-top: 10px; margin-left: 10px; background: #666;">
                        <i class="fas fa-redo"></i> GENERATE BARU
                    </button>
                </div>
                
                <!-- INPUT KODE DEVICE LAIN -->
                <div class="input-area">
                    <div class="input-label">
                        <i class="fas fa-sign-in-alt"></i> MASUKKAN KODE DEVICE 2:
                    </div>
                    <div class="input-group">
                        <input type="text" 
                               id="input1" 
                               class="code-input" 
                               placeholder="CONTOH: EFGH"
                               maxlength="4"
                               onkeyup="this.value = this.value.toUpperCase()">
                        <button onclick="connectDevice('1')" id="connectBtn1">
                            CONNECT
                        </button>
                    </div>
                </div>
                
                <!-- STATUS KONEKSI -->
                <div class="status">
                    <span class="dot" id="status1"></span>
                    <span id="statusText1">Belum terhubung</span>
                </div>
                
                <!-- AREA TRANSFER FILE -->
                <div id="transferArea1" class="hidden">
                    <h3 style="color: #00ffff; margin-top: 20px;">
                        <i class="fas fa-file-upload"></i> KIRIM FILE
                    </h3>
                    
                    <div class="file-zone" onclick="document.getElementById('file1').click()">
                        <input type="file" id="file1" style="display: none;" multiple>
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3em; color: #00ffff;"></i>
                        <p style="margin-top: 10px;">Drag & drop file atau klik disini</p>
                    </div>
                    
                    <div class="file-list" id="fileList1"></div>
                    
                    <button class="transfer-btn" onclick="sendFiles('1')" id="sendBtn1" disabled>
                        <i class="fas fa-paper-plane"></i> KIRIM FILE
                    </button>
                    
                    <h3 style="color: #ffaa00; margin-top: 30px;">
                        <i class="fas fa-download"></i> FILE DITERIMA
                    </h3>
                    <div class="file-list" id="receivedList1"></div>
                    
                    <button class="download-btn" onclick="downloadAll('1')" id="downloadBtn1" disabled>
                        <i class="fas fa-download"></i> DOWNLOAD SEMUA FILE
                    </button>
                </div>
            </div>
            
            <!-- DEVICE 2 - PHONE -->
            <div class="device">
                <div class="device-header">
                    <i class="fas fa-mobile-alt"></i>
                    <h2>DEVICE 2 - PHONE</h2>
                </div>
                
                <!-- KODE DEVICE 2 -->
                <div class="code-box">
                    <div style="color: #88ffff; margin-bottom: 5px;">üîë KODE ANDA</div>
                    <div class="code" id="code2">EFGH</div>
                    <button onclick="copyCode('2')" style="margin-top: 10px;">
                        <i class="fas fa-copy"></i> COPY KODE
                    </button>
                    <button onclick="newCode('2')" style="margin-top: 10px; margin-left: 10px; background: #666;">
                        <i class="fas fa-redo"></i> GENERATE BARU
                    </button>
                </div>
                
                <!-- INPUT KODE DEVICE LAIN -->
                <div class="input-area">
                    <div class="input-label">
                        <i class="fas fa-sign-in-alt"></i> MASUKKAN KODE DEVICE 1:
                    </div>
                    <div class="input-group">
                        <input type="text" 
                               id="input2" 
                               class="code-input" 
                               placeholder="CONTOH: ABCD"
                               maxlength="4"
                               onkeyup="this.value = this.value.toUpperCase()">
                        <button onclick="connectDevice('2')" id="connectBtn2">
                            CONNECT
                        </button>
                    </div>
                </div>
                
                <!-- STATUS KONEKSI -->
                <div class="status">
                    <span class="dot" id="status2"></span>
                    <span id="statusText2">Belum terhubung</span>
                </div>
                
                <!-- AREA TRANSFER FILE -->
                <div id="transferArea2" class="hidden">
                    <h3 style="color: #00ffff; margin-top: 20px;">
                        <i class="fas fa-file-upload"></i> KIRIM FILE
                    </h3>
                    
                    <div class="file-zone" onclick="document.getElementById('file2').click()">
                        <input type="file" id="file2" style="display: none;" multiple>
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3em; color: #00ffff;"></i>
                        <p style="margin-top: 10px;">Drag & drop file atau klik disini</p>
                    </div>
                    
                    <div class="file-list" id="fileList2"></div>
                    
                    <button class="transfer-btn" onclick="sendFiles('2')" id="sendBtn2" disabled>
                        <i class="fas fa-paper-plane"></i> KIRIM FILE
                    </button>
                    
                    <h3 style="color: #ffaa00; margin-top: 30px;">
                        <i class="fas fa-download"></i> FILE DITERIMA
                    </h3>
                    <div class="file-list" id="receivedList2"></div>
                    
                    <button class="download-btn" onclick="downloadAll('2')" id="downloadBtn2" disabled>
                        <i class="fas fa-download"></i> DOWNLOAD SEMUA FILE
                    </button>
                </div>
            </div>
        </div>
        
        <!-- LOG ACTIVITY -->
        <div class="logs" id="logs">
            <div>[SYSTEM] Siap koneksi. Masukkan kode device lain untuk connect.</div>
        </div>
    </div>

    <script>
        // DATA DEVICE
        let device1 = {
            code: 'ABCD',
            connected: false,
            connectedTo: null,
            files: [],
            received: []
        };
        
        let device2 = {
            code: 'EFGH',
            connected: false,
            connectedTo: null,
            files: [],
            received: []
        };

        // INIT
        window.onload = function() {
            updateDisplay();
            log('Device 1 code: ABCD');
            log('Device 2 code: EFGH');
            log('Cara connect: Masukkan kode device lain di input box');
        };

        // UPDATE TAMPILAN
        function updateDisplay() {
            document.getElementById('code1').innerText = device1.code;
            document.getElementById('code2').innerText = device2.code;
        }

        // GENERATE KODE BARU
        function newCode(device) {
            let code = '';
            let chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            for (let i = 0; i < 4; i++) {
                code += chars[Math.floor(Math.random() * chars.length)];
            }
            
            if (device === '1') {
                device1.code = code;
                log('Device 1 generate kode baru: ' + code);
            } else {
                device2.code = code;
                log('Device 2 generate kode baru: ' + code);
            }
            
            updateDisplay();
        }

        // COPY KODE
        function copyCode(device) {
            let code = device === '1' ? device1.code : device2.code;
            navigator.clipboard.writeText(code);
            alert('Kode ' + code + ' berhasil di copy!');
            log('Device ' + device + ' copy kode: ' + code);
        }

        // CONNECT DEVICE
        function connectDevice(device) {
            let inputId = 'input' + device;
            let inputCode = document.getElementById(inputId).value;
            
            if (inputCode.length !== 4) {
                alert('Masukkan 4 digit kode!');
                return;
            }
            
            if (device === '1') {
                // Device 1 connect ke Device 2
                if (inputCode === device2.code) {
                    device1.connected = true;
                    device1.connectedTo = '2';
                    
                    // Update UI
                    document.getElementById('status1').className = 'dot green';
                    document.getElementById('statusText1').innerText = 'Terhubung ke Device 2';
                    document.getElementById('connectBtn1').innerHTML = '‚úì TERHUBUNG';
                    document.getElementById('connectBtn1').disabled = true;
                    document.getElementById('transferArea1').classList.remove('hidden');
                    
                    log('‚úÖ Device 1 terhubung ke Device 2');
                    
                    // Cek apakah 2 arah sudah connect
                    if (device2.connected && device2.connectedTo === '1') {
                        log('üéâ KONEKSI 2 ARAH SUKSES!');
                        alert('‚úÖ Koneksi 2 arah berhasil! Kedua device siap transfer file.');
                    }
                } else {
                    alert('Kode salah! Masukkan kode dari Device 2');
                }
            } else {
                // Device 2 connect ke Device 1
                if (inputCode === device1.code) {
                    device2.connected = true;
                    device2.connectedTo = '1';
                    
                    // Update UI
                    document.getElementById('status2').className = 'dot green';
                    document.getElementById('statusText2').innerText = 'Terhubung ke Device 1';
                    document.getElementById('connectBtn2').innerHTML = '‚úì TERHUBUNG';
                    document.getElementById('connectBtn2').disabled = true;
                    document.getElementById('transferArea2').classList.remove('hidden');
                    
                    log('‚úÖ Device 2 terhubung ke Device 1');
                    
                    // Cek apakah 2 arah sudah connect
                    if (device1.connected && device1.connectedTo === '2') {
                        log('üéâ KONEKSI 2 ARAH SUKSES!');
                        alert('‚úÖ Koneksi 2 arah berhasil! Kedua device siap transfer file.');
                    }
                } else {
                    alert('Kode salah! Masukkan kode dari Device 1');
                }
            }
        }

        // HANDLE UPLOAD FILE
        function setupFileUpload() {
            // Device 1
            document.getElementById('file1').addEventListener('change', function(e) {
                handleFiles('1', e.target.files);
            });
            
            // Device 2
            document.getElementById('file2').addEventListener('change', function(e) {
                handleFiles('2', e.target.files);
            });
            
            // Drag & drop Device 1
            let zone1 = document.querySelector('#transferArea1 .file-zone');
            zone1.addEventListener('dragover', (e) => e.preventDefault());
            zone1.addEventListener('drop', (e) => {
                e.preventDefault();
                handleFiles('1', e.dataTransfer.files);
            });
            
            // Drag & drop Device 2
            let zone2 = document.querySelector('#transferArea2 .file-zone');
            zone2.addEventListener('dragover', (e) => e.preventDefault());
            zone2.addEventListener('drop', (e) => {
                e.preventDefault();
                handleFiles('2', e.dataTransfer.files);
            });
        }

        // HANDLE FILES
        function handleFiles(device, files) {
            if (files.length === 0) return;
            
            for (let file of files) {
                let fileData = {
                    name: file.name,
                    size: file.size,
                    type: file.type || 'unknown',
                    file: file,
                    progress: 0
                };
                
                if (device === '1') {
                    device1.files.push(fileData);
                } else {
                    device2.files.push(fileData);
                }
            }
            
            updateFileList(device);
            enableSendButton(device);
            log(`Device ${device} upload ${files.length} file`);
        }

        // UPDATE LIST FILE
        function updateFileList(device) {
            let listId = 'fileList' + device;
            let list = document.getElementById(listId);
            let files = device === '1' ? device1.files : device2.files;
            
            if (files.length === 0) {
                list.innerHTML = '<div style="color: #888; text-align: center;">Belum ada file</div>';
                return;
            }
            
            let html = '';
            files.forEach((file, index) => {
                let icon = 'üìÑ';
                if (file.type.includes('image')) icon = 'üñºÔ∏è';
                if (file.type.includes('video')) icon = 'üé¨';
                if (file.type.includes('audio')) icon = 'üéµ';
                
                html += `
                    <div class="file-item">
                        <div>
                            <span style="font-size: 1.2em;">${icon}</span>
                            <span style="margin-left: 10px;">${file.name}</span>
                            <span style="color: #88ffff; margin-left: 10px; font-size: 0.8em;">${formatSize(file.size)}</span>
                        </div>
                        <div>
                            <i class="fas fa-times" style="color: red; cursor: pointer;" onclick="removeFile('${device}', ${index})"></i>
                        </div>
                    </div>
                `;
            });
            
            list.innerHTML = html;
        }

        // REMOVE FILE
        function removeFile(device, index) {
            if (device === '1') {
                device1.files.splice(index, 1);
            } else {
                device2.files.splice(index, 1);
            }
            updateFileList(device);
            enableSendButton(device);
        }

        // ENABLE SEND BUTTON
        function enableSendButton(device) {
            let files = device === '1' ? device1.files : device2.files;
            let btnId = 'sendBtn' + device;
            document.getElementById(btnId).disabled = files.length === 0;
        }

        // SEND FILES
        function sendFiles(device) {
            let source = device === '1' ? device1 : device2;
            let target = device === '1' ? device2 : device1;
            
            if (!source.connected) {
                alert('Belum terhubung!');
                return;
            }
            
            let files = source.files;
            if (files.length === 0) return;
            
            log(`Device ${device} mengirim ${files.length} file...`);
            
            // Simulasi transfer
            files.forEach((file, index) => {
                setTimeout(() => {
                    target.received.push({
                        name: file.name,
                        size: file.size,
                        type: file.type
                    });
                    
                    updateReceivedList(device === '1' ? '2' : '1');
                    
                    log(`‚úÖ File ${file.name} terkirim`);
                }, index * 1000);
            });
            
            // Kosongkan file setelah terkirim
            source.files = [];
            updateFileList(device);
            enableSendButton(device);
            
            // Enable download button
            setTimeout(() => {
                let targetDevice = device === '1' ? '2' : '1';
                document.getElementById('downloadBtn' + targetDevice).disabled = false;
            }, files.length * 1000);
        }

        // UPDATE LIST RECEIVED
        function updateReceivedList(device) {
            let listId = 'receivedList' + device;
            let list = document.getElementById(listId);
            let files = device === '1' ? device1.received : device2.received;
            
            if (files.length === 0) {
                list.innerHTML = '<div style="color: #888; text-align: center;">Belum ada file diterima</div>';
                return;
            }
            
            let html = '';
            files.forEach((file, index) => {
                let icon = 'üìÑ';
                if (file.type.includes('image')) icon = 'üñºÔ∏è';
                if (file.type.includes('video')) icon = 'üé¨';
                if (file.type.includes('audio')) icon = 'üéµ';
                
                html += `
                    <div class="file-item">
                        <div>
                            <span style="font-size: 1.2em;">${icon}</span>
                            <span style="margin-left: 10px;">${file.name}</span>
                            <span style="color: #88ffff; margin-left: 10px; font-size: 0.8em;">${formatSize(file.size)}</span>
                        </div>
                        <div>
                            <i class="fas fa-download" style="color: #00ff88; cursor: pointer;" onclick="downloadFile('${device}', ${index})"></i>
                        </div>
                    </div>
                `;
            });
            
            list.innerHTML = html;
        }

        // DOWNLOAD FILE
        function downloadFile(device, index) {
            let file = device === '1' ? device1.received[index] : device2.received[index];
            
            let content = `File: ${file.name}\nSize: ${file.size}\nTransferred via Wireless File Transfer`;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            
            let a = document.createElement('a');
            a.href = url;
            a.download = file.name;
            a.click();
            
            URL.revokeObjectURL(url);
            log(`Device ${device} download: ${file.name}`);
        }

        // DOWNLOAD ALL
        function downloadAll(device) {
            let files = device === '1' ? device1.received : device2.received;
            
            files.forEach((file, index) => {
                setTimeout(() => {
                    downloadFile(device, index);
                }, index * 500);
            });
            
            log(`Device ${device} download ${files.length} file`);
        }

        // FORMAT SIZE
        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
        }

        // LOG
        function log(msg) {
            let logs = document.getElementById('logs');
            let time = new Date().toLocaleTimeString();
            let entry = document.createElement('div');
            entry.style.padding = '3px 0';
            entry.style.borderBottom = '1px solid #333';
            entry.innerHTML = `[${time}] ${msg}`;
            logs.appendChild(entry);
            logs.scrollTop = logs.scrollHeight;
            
            if (logs.children.length > 10) {
                logs.removeChild(logs.children[0]);
            }
        }

        // INIT FILE UPLOAD
        setupFileUpload();
    </script>
</body>
</html>
